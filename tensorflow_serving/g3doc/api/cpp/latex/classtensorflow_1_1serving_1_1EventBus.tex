\hypertarget{classtensorflow_1_1serving_1_1EventBus}{}\doxysection{tensorflow\+::serving\+::Event\+Bus$<$ E $>$ Class Template Reference}
\label{classtensorflow_1_1serving_1_1EventBus}\index{tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}}


{\ttfamily \#include $<$event\+\_\+bus.\+h$>$}



Inheritance diagram for tensorflow\+::serving\+::Event\+Bus$<$ E $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{classtensorflow_1_1serving_1_1EventBus__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for tensorflow\+::serving\+::Event\+Bus$<$ E $>$\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{classtensorflow_1_1serving_1_1EventBus__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1EventAndTime}{Event\+And\+Time}}
\begin{DoxyCompactList}\small\item\em Event and the publish time associated with it. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1Options}{Options}}
\item 
class \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_1_1Subscription}{Subscription}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}{Callback}} = std\+::function$<$ void(const \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1EventAndTime}{Event\+And\+Time}} \&)$>$
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_1_1Subscription}{Subscription}} $>$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a39fe8c3ad82da890bdc4455dc05a43fb}{Subscribe}} (const \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}{Callback}} \&callback) TF\+\_\+\+LOCKS\+\_\+\+EXCLUDED(mutex\+\_\+) TF\+\_\+\+MUST\+\_\+\+USE\+\_\+\+RESULT
\item 
\mbox{\Hypertarget{classtensorflow_1_1serving_1_1EventBus_a29a951f5d7d4e6f7a85bf8d3b4c463f8}\label{classtensorflow_1_1serving_1_1EventBus_a29a951f5d7d4e6f7a85bf8d3b4c463f8}} 
void \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a29a951f5d7d4e6f7a85bf8d3b4c463f8}{Publish}} (const E \&event) TF\+\_\+\+LOCKS\+\_\+\+EXCLUDED(mutex\+\_\+)
\begin{DoxyCompactList}\small\item\em Publishes an event to all subscribers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} $>$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_abdf7f12c47dab911dfa5adbc8c3031c5}{Create\+Event\+Bus}} (const \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1Options}{Options}} \&options=\{\})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename E$>$\newline
class tensorflow\+::serving\+::\+Event\+Bus$<$ E $>$}

\mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} enables basic publish / subscribe semantics for events amongst one or more publishers and subscribers. The purpose of \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} for serving is to de-\/couple the code for such events, and is optimized for that use-\/case.

\mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} and Subscriptions can be destroyed safely in any order. There is a strict requirement for memory safety that a \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_1_1Subscription}{Subscription}} must be destroyed before any of the objects or memory that a subscriber\textquotesingle{}s callback accesses.

Important scaling and threading limitations\+:

Scaling\+: The \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} is not currently optimized for high scale, either in the number of subscribers or frequency of events. For such use-\/cases, consider alternate implementations or upgrades to this class.

Threading\+: \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} is thread-\/safe. However, if any subscriber callback calls any method in the \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}}, it will deadlock. Subscribers are notified serially on the event publisher\textquotesingle{}s thread. Thus, the amount of work done in a subscriber\textquotesingle{}s callback should be very minimal.

This implementation is single-\/binary and does not communicate across tasks.

Note that the types used for typename E in \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} must be moveable and thread-\/safe. Future implementations may read Events of type E in multiple threads. 

\doxysubsection{Member Typedef Documentation}
\mbox{\Hypertarget{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}\label{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}} 
\index{tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}!Callback@{Callback}}
\index{Callback@{Callback}!tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}}
\doxysubsubsection{\texorpdfstring{Callback}{Callback}}
{\footnotesize\ttfamily template$<$typename E $>$ \\
using \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{tensorflow\+::serving\+::\+Event\+Bus}}$<$ E $>$\+::\mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}{Callback}} =  std\+::function$<$void(const \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1EventAndTime}{Event\+And\+Time}}\&)$>$}

The function type for \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} Callbacks to be implemented by clients. Important Warnings\+:
\begin{DoxyItemize}
\item Callbacks must not themselves callback to the \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} for any purpose including subscribing, publishing or unsubscribing. This will cause a circular deadlock.
\item Callbacks must do very little work as they are invoked on the publisher\textquotesingle{}s thread. Any costly work should be performed asynchronously. 
\end{DoxyItemize}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classtensorflow_1_1serving_1_1EventBus_abdf7f12c47dab911dfa5adbc8c3031c5}\label{classtensorflow_1_1serving_1_1EventBus_abdf7f12c47dab911dfa5adbc8c3031c5}} 
\index{tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}!CreateEventBus@{CreateEventBus}}
\index{CreateEventBus@{CreateEventBus}!tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}}
\doxysubsubsection{\texorpdfstring{CreateEventBus()}{CreateEventBus()}}
{\footnotesize\ttfamily template$<$typename E $>$ \\
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}}$<$ E $>$ $>$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{tensorflow\+::serving\+::\+Event\+Bus}}$<$ E $>$\+::Create\+Event\+Bus (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structtensorflow_1_1serving_1_1EventBus_1_1Options}{Options}} \&}]{options = {\ttfamily \{\}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Creates an \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} and returns a shared\+\_\+ptr to it. This is the only allowed public mechanism for creating an \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} so that we can track references to an \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}} uniformly. \mbox{\Hypertarget{classtensorflow_1_1serving_1_1EventBus_a39fe8c3ad82da890bdc4455dc05a43fb}\label{classtensorflow_1_1serving_1_1EventBus_a39fe8c3ad82da890bdc4455dc05a43fb}} 
\index{tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}!Subscribe@{Subscribe}}
\index{Subscribe@{Subscribe}!tensorflow::serving::EventBus$<$ E $>$@{tensorflow::serving::EventBus$<$ E $>$}}
\doxysubsubsection{\texorpdfstring{Subscribe()}{Subscribe()}}
{\footnotesize\ttfamily template$<$typename E $>$ \\
std\+::unique\+\_\+ptr$<$ typename \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}}$<$ E $>$\+::\mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_1_1Subscription}{Subscription}} $>$ \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{tensorflow\+::serving\+::\+Event\+Bus}}$<$ E $>$\+::Subscribe (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_a5d602ec2a5a845d27799970475af24b9}{Callback}} \&}]{callback }\end{DoxyParamCaption})}

Subscribes to all events on the \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus}{Event\+Bus}}.

Returns a \mbox{\hyperlink{classtensorflow_1_1serving_1_1EventBus_1_1Subscription}{Subscription}} RAII object that can be used to unsubscribe, or will automatically unsubscribe on destruction. Returns a unique\+\_\+ptr so that we can use the subscription\textquotesingle{}s address to Unsubscribe.

Important contract for unsubscribing (deleting the RAII object)\+:
\begin{DoxyItemize}
\item Unsubscribing (deleting the RAII object) may block while currently scheduled callback invocation(s) finish.
\item Once it returns no callback invocations will occur. Callers\textquotesingle{} destructors must use the sequence\+: (1) Unsubscribe. (2) Tear down anything that the callback references. 
\end{DoxyItemize}

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
tensorflow\+\_\+serving/util/event\+\_\+bus.\+h\end{DoxyCompactItemize}
